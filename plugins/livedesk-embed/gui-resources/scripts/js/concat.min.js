define("utils/class",[],function(){var c=!1,a=function(){};a.extend=function(a,e){function b(){if(!c&&(this._constructor||this._construct))try{return(this._construct||this._constructor).apply(this,arguments)}catch(b){console.error(b)}}c=!0;var d=new this;c=!1;for(var g in a)d[g]=a[g];b.prototype=d;b.prototype.constructor=b;b.extend=arguments.callee;return b};return a});
define("gizmo",["jquery","utils/class"],function(c,a){function f(b,d){var c;if("undefined"==typeof b||"undefined"==typeof d)return!0;for(c in d)if("undefined"==typeof b[c])return!0;for(c in b)if("undefined"==typeof d[c])return!0;for(c in d)if(d[c])switch(typeof d[c]){case "object":if(f(d[c],b[c]))return!0;break;case "function":if("undefined"==typeof b[c]||d[c].toString()!=b[c].toString())return!0;break;default:if(d[c]!=b[c])return!0}else if(b[c])return!0;return!1}var e=function(){},b=function(){},
d=function(){this.items={}},g=function(){},h=a.extend({_construct:function(b){this.data=!this.data?{root:""}:this.data;switch(c.type(b)){case "string":this.data.url=b;break;case "array":this.data.url=b[0];void 0!==b[1]&&(this.data.xfilter=url[0]);break;case "object":this.data.url=b.url,void 0!==b.xfilter&&(this.data.xfilter=b.xfilter)}return this},xfilter:function(){this.data.xfilter=1<arguments.length?c.makeArray(arguments).join(","):c.isArray(arguments[0])?arguments[0].join(","):arguments[0];return this},
root:function(b){this.data.root=b;return this},get:function(){return this.data.root+this.data.url},order:function(b,d){this.data.order=d+"\x3d"+b;return this},filter:function(b,d){this.data.filter=b+"\x3d"+d;return this},decorate:function(b){this.data.url=b.replace(/(%s)/g,this.data.url)},options:function(){var b={};this.data.xfilter&&(b.headers={"X-Filter":this.data.xfilter});return b}}),k={request:function(b){var d=this,a=function(a,e,r){c.support.cors=!0;b instanceof h?(e=c.extend(!0,{},e,d.options,
r,{data:a},b.options()),a=c.ajax(d.href(b.get()),e)):(e=c.extend(!0,{},e,d.options,r,{data:a}),a=c.ajax(d.href(b),e));d.reset();e.fail&&a.fail(e.fail);e.done&&a.done(e.done);e.always&&a.always(e.always);return a};return{read:function(b){return a({},d.readOptions,b)},update:function(b,s){return a(b,d.updateOptions,s)},insert:function(b,s){return a(b,d.insertOptions,s)},remove:function(b){return a({},d.removeOptions,b)}}},href:function(b){return b},reset:c.noop,options:{},readOptions:{dataType:"json",
type:"get",headers:{Accept:"text/json"}},updateOptions:{type:"post",headers:{"X-HTTP-Method-Override":"PUT"}},insertOptions:{dataType:"json",type:"post",headers:{"Content-Type":"application/x-www-form-urlencoded; charset\x3dUTF-8"}},removeOptions:{type:"get",headers:{"X-HTTP-Method-Override":"DELETE"}}},j=0;b.prototype={_changed:!1,_new:!1,defaults:{},data:{},_construct:function(b,d){this._clientId=j++;this.data={};this.parseHash(b);this._new=!0;var a=this.pushUnique?this.pushUnique():this;a._forDelete=
!1;a.clearChangeset();a._clientHash=null;d&&"object"==typeof d&&c.extend(a,d);"object"==typeof b&&a._parse(b);a._setExpiration();a.isDeleted()?a._remove():c.isEmptyObject(a.changeset)?a.clearChangeset().triggerHandler("read"):a.triggerHandler("update",a.changeset).clearChangeset();return a},syncAdapter:k,feed:function(d,c,a){d={};a=a?a:this.data;for(var e in a)d[e]=a[e]instanceof b?c?a[e].feed(c):a[e].relationHash()||a[e].hash():a[e];return d},sync:function(b,d){var a=this,e=c.Deferred(),f=function(){return a.syncAdapter.request.apply(a.syncAdapter,
arguments)};this.hash();a.triggerHandler("sync");if(this._forDelete)return f(b||this.href).remove().done(function(){a._remove()});if(this._clientHash)return f(b||this.href).insert(this.feed()).done(function(b){a._changed=!1;a._parse(b);a._uniq&&a._uniq.replace(a._clientHash,a.hash(),a);a._clientHash=null;a.triggerHandler("insert").Class.triggerHandler("insert",a);a.triggerHandler("synced")});this._changed?c.isEmptyObject(this.changeset)||(e=this.href&&f(this.href).update(d?this.feed():this.feed("json",
!1,this.changeset)).done(function(){a.triggerHandler("update",a.changeset).clearChangeset();a.triggerHandler("synced")})):(!b||!b.force)&&this.exTime&&this.exTime>new Date?a.isDeleted()||(a.triggerHandler("update"),a.triggerHandler("synced")):e=this.href&&f(this.href).read(b).done(function(b){a._parse(b);a.isDeleted()?a._remove():c.isEmptyObject(a.changeset)?a.clearChangeset().triggerHandler("read"):a.triggerHandler("update",a.changeset).clearChangeset();a.triggerHandler("synced")});this._setExpiration();
return e},_setExpiration:function(){this.exTime=new Date;this.exTime.setSeconds(this.exTime.getSeconds()+5)},_remove:function(){this.triggerHandler("delete");this._uniq&&this._uniq.remove(this.hash())},remove:function(){this._forDelete=!0;return this},isDeleted:function(){return this._forDelete},modelDataBuild:function(b){return b},parse:function(b){return b},_parse:function(d){d=d instanceof b?d.data:this.parse(d);if(!d._parsed){for(var a in d){if(this.defaults[a])switch(!0){case "function"===typeof this.defaults[a]&&
void 0===this.data[a]:var e=this.modelDataBuild(new this.defaults[a](d[a]));!this._new&&(e!=this.data[a]&&!(e instanceof g))&&(this.changeset[a]=e);this.data[a]=e;!d[a].href&&this.data[a].relationHash&&this.data[a].relationHash(d[a]);continue;case c.isArray(this.defaults[a]):this.data[a]=this.modelDataBuild(new g(this.defaults[a][0],d[a].href));delete this.data[a];continue;case this.defaults[a]instanceof g:case this.defaults[a]instanceof b:this.data[a]=this.defaults[a];continue}else this._new||("object"===
c.type(d[a])?f(this.data[a],d[a])&&(this.changeset[a]=d[a]):this.data[a]!=d[a]&&(this.changeset[a]=d[a]));"object"===c.type(d[a])&&"object"===c.type(this.data[a])?c.extend(!0,this.data[a],d[a]):this.data[a]=d[a]}this._new=!1;d._parsed=!0}},parseHash:function(a){if(a instanceof b)return this;"string"==typeof a?this.href=a:a&&void 0!==a.href?(this.href=a.href,delete a.href):a&&(void 0!==a.id&&void 0!==this.url)&&(this.href=this.url+a.id);return this},isChanged:function(){return!c.isEmptyObject(this.changeset)},
clearChangeset:function(){this._changed=!1;this.changeset={};return this},get:function(b){return this.data[b]},set:function(b,a,d){var e={};"string"===c.type(b)?e[b]=a:(e=b,d=a);d=c.extend({},{silent:!1},d);this.clearChangeset()._parse(e);this._changed=!0;c.isEmptyObject(this.changeset)||d.silent||this.triggerHandler("set",this.changeset);return this},_getClientHash:function(){this._clientHash||(this._clientHash="mcid-"+String(this._clientId));return this._clientHash},hash:function(){!this.href&&
this.data.href&&(this.href=this.data.href);return this.data.href||this.href||this._getClientHash()},relationHash:function(b){b&&(this.data.Id=b);return this.data.Id},off:function(b,a){c(this).off(b,a);return this},on:function(b,a,d){if(void 0===d)c(this).off(b,a),c(this).on(b,a);else c(this).on(b,function(){a.apply(d,arguments)});return this},one:function(b,a,d){if(void 0===d)c(this).off(b,a),c(this).one(b,a);else c(this).one(b,function(){a.apply(d,arguments)});return this},trigger:function(b,a){c(this).trigger(b,
a);return this},triggerHandler:function(b,a){c(this).triggerHandler(b,a);return this}};d.prototype={items:{},garbageTime:1500,refresh:function(b){b._exTime||(b._exTime=new Date);b._exTime.setTime(b._exTime.getTime()+this.garbageTime)},set:function(b,a){var d=this;c(a).on("sync get get-prop set-prop",function(){d.refresh(this)});d.refresh(a);this.items[b]||(this.items[b]=a);return this.items[b]},replace:function(b,a,d){delete this.items[b];return this.set(a,d)},garbage:function(){for(var b in this.items)this.items[b]._exTime&&
this.items[b]._exTime<new Date&&(c(this.items[b]).triggerHandler("garbage"),delete this.items[b])},remove:function(b){delete this.items[b]}};var l=b.options={},m,o;b.extend=m=function(b,d){var f;f=a.extend.call(this,b);f.extend=m;f.prototype.Class=f;f.on=function(b,a,d){c(f).on(b,function(){a.apply(d,arguments)});return f};f.off=function(b,a){c(f).off(b,a);return f};f.triggerHandler=function(b,a){c(f).triggerHandler(b,a)};d&&d.register&&(e[d.register]=f,delete d.register);f.prototype.options=c.extend({},
d);return f};g.prototype={_list:[],_events:{},getList:function(){return this._list},count:function(){return this._list.length},_construct:function(){this.model||(this.model=b);this._list=[];this._events={};this.desynced=!0;for(var a=buildOptions=function(){void 0},d=0,e=arguments.length;d<e;d++)switch(c.type(arguments[d])){case "function":this.model=arguments[d];break;case "string":this.href=arguments[d];break;case "array":a=function(b){return function(){this._list=this._parse(b)}}(arguments[d]);
break;case "object":buildOptions=function(b){return function(){this.options=b;b.href&&(this.href=b.href)}}(arguments[d])}buildOptions.call(this);a.call(this);l=c.extend({},{init:!0},this.options);l.init&&this.init.apply(this,arguments)},init:function(){},get:function(b){var a=c.Deferred(),d=this;searchKey=function(){for(var c=0;c<d._list.length;c++)if(b==d._list[c].hash()||b==d._list[c].relationHash())return a.resolve(d._list[c]);a.reject()};this.desynced&&this.sync().done(function(){a.resolve(searchKey())})?
a:searchKey();return a},remove:function(b){for(var a in this._list)if(b==this._list[a].hash()||b==this._list[a].relationHash()){Array.prototype.splice.call(this._list,a,1);break}return this},syncAdapter:k,setHref:function(b){this.href=b;return this},each:function(b){c.each(this._list,b)},forwardEach:function(b,a){this._list.forEach(b,a)},reverseEach:function(b,a){for(var d=this._list.length;0<d;++d)b.call(a||this,this[d],d,this)},feed:function(b,a){var d=[],c;for(c in this._list)d[c]=this._list[c].feed(b,
a);return d},sync:function(b){var a=this;return this.href&&this.syncAdapter.request.call(this.syncAdapter,this.href).read(b).done(function(b){var d=a.parseAttributes(b);a.parse(b);list=a._parse(b);changeset=[];removeings=[];updates=[];addings=[];count=a._list.length;for(b=0;b<list.length;b++){for(var c=!1,e=0;e<count;e++)if(list[b].hash()==a._list[e].hash()){c=list[b];break}if(c)if(a.hasEvent("updates")&&updates.push(c),a.isCollectionDeleted(c)&&(a._list.splice(b,1),a.hasEvent("removeings")&&removeings.push(c)),
c.isDeleted())c._remove();else if(c.isChanged())changeset.push(c);else c.on("delete",function(){a.remove(this.hash())}).on("garbage",function(){this.desynced=!0});else list[b].isDeleted()?a.hasEvent("updates")&&updates.push(list[b]):(a._list.push(list[b]),changeset.push(list[b]),a.hasEvent("addings")&&addings.push(list[b]))}a.desynced=!1;0===count?a.triggerHandler("read",[a._list,d]):(updates.length&&a.hasEvent("updates")&&a.triggerHandler("updates",[updates,d]),addings.length&&a.hasEvent("addings")&&
a.triggerHandler("addings",[addings,d]),removeings.length&&a.hasEvent("removeings")&&a.triggerHandler("removeings",[removeings,d]),a.triggerHandler("update",[changeset,d]))})},isCollectionDeleted:function(){return!1},modelDataBuild:function(b){return b},parseAttributes:function(b){return b},parse:function(b){var a=b;if(!Array.isArray(b))for(i in b)if(c.isArray(b[i])){a=b[i];break}return a},_parse:function(b){b=this.parse(b);for(var a=[],d=0,c=b.length;d<c;d++)a.push(this.modelDataBuild(new this.model(b[d])));
return a},insert:function(a){this.desynced=!1;a instanceof b||(a=this.modelDataBuild(new this.model(a)));this._list.push(a);a.hash();return a.sync(this.href)},off:function(b,a){c(this).off(b,a);for(var d=b.split(" "),e=0,f=d.length;e<f;e++)delete this._events[d[e]];return this},on:function(b,a,d){if(void 0===d)c(this).off(b,a),c(this).on(b,a);else c(this).on(b,function(){a.apply(d,arguments)});b=b.split(" ");for(var e=0,f=b.length;e<f;e++)this._events[b[e]]=!0;return this},one:function(b,a,d){if(void 0===
d)c(this).off(b,a),c(this).one(b,a);else c(this).one(b,function(){a.apply(d,arguments)});return this},trigger:function(b,a){c(this).trigger(b,a);return this},triggerHandler:function(b,a){c(this).triggerHandler(b,a);return this},hasEvent:function(b){return"undefined"===c.type(this._events[b])?!1:this._events[b]}};g.extend=o=function(b,d){var f;f=a.extend.call(this,b);f.extend=o;d&&d.register&&(e[d.register]=f,delete d.register);f.prototype.options=c.extend({},d);return f};var p=0,t=a.extend({getProperty:function(b){return!this[b]?
null:"function"===typeof this[b]?this[b]():this[b]}}).extend({tagName:"div",attributes:{className:"",id:""},namespace:"view",_constructor:function(b,a){c.extend(this,b);this._clientId=p++;a=c.extend({},{init:!0,events:!0,ensure:!0},a);a.ensure&&this._ensureElement();a.init&&this.init.apply(this,arguments);a.events&&this.resetEvents()},_ensureElement:function(){var b=this.attributes.className,a=this.attributes.id,d="";c(this.el).length?this.el=c(this.el):("string"===c.type(this.el)&&("."==this.el[0]&&
(b+=this.el.substr(0,1)),"#"==this.el[0]&&(a=this.el.substr(0,1))),d="\x3c"+this.tagName,""!==b&&(d=d+' class\x3d"'+b+'"'),""!==a&&(d=d+' id\x3d"'+a+'"'),d=d+"\x3e\x3c/"+this.tagName+"\x3e",this.el=c(d))},init:function(){return this},resetEvents:function(){this.undelegateEvents();this.delegateEvents()},delegateEvents:function(b){if(b||(b=this.getProperty("events")))for(var a in b){var d=b[a],e;for(e in d){var f=d[e];if("string"===typeof f&&c.isFunction(this[f]))c(this.el).on(this.getEvent(e),a,this[f].bind(this))}}},
undelegateEvents:function(){c(this.el).off(this.getNamespace());return this},getEvent:function(b){return b+this.getNamespace()},getNamespace:function(){return"."+this.getProperty("namespace")},render:function(){this.delegateEvents();return this},remove:function(){c(this.el).remove();this.destroy();return this},destroy:function(){this.model&&this.model.trigger("destroy");this.collection&&this.collection.trigger("destroy");return this},checkElement:function(){return void 0===this.el?!1:void 0!==this.el.selector&&
""!=this.el.selector?1===c(this.el.selector).length:c(this.el).is(":visible")},setElement:function(b){this.undelegateEvents();b=c(b);var a=this.el.data();this.el.replaceWith(b);this.el=b;this.el.data(a);this.delegateEvents();return this},resetElement:function(b){this.el=c(b);this._ensureElement();this.delegateEvents()}});return{Model:b,Collection:g,Sync:k,UniqueContainer:d,View:t,Url:h,Register:e}});
define("gizmo/superdesk",["jquery","gizmo"],function(c,a){var f=c.extend({},a.Sync,{reset:function(){try{delete this.options.headers["X-Filter"],this.options.data={}}catch(b){}}}),e=function(){AuthApp.success=function(){};AuthApp.require.apply(this,arguments)},b=c.extend({},f,{options:{fail:function(a){401==a.status&&e.apply(b,arguments);404==a.status&&ErrorApp.require.apply(this,arguments)}},href:function(b){return-1===b.indexOf("my/")?b.replace("resources/","resources/my/"):b}}),d=function(){this.syncAdapter.options.headers||
(this.syncAdapter.options.headers={});this._xfilter=1<arguments.length?c.makeArray(arguments).join(","):c.isArray(arguments[0])?arguments[0].join(","):arguments[0];this.syncAdapter.options.headers["X-Filter"]=this._xfilter;this.syncAdapter.options.headers["X-Format-DateTime"]="yyyy-MM-ddTHH:mm:ss'Z'";return this},g=function(b,a){void 0===b?delete this.syncAdapter.options.data[a]:(void 0===this.syncAdapter.options.data&&(this.syncAdapter.options.data={}),this.syncAdapter.options.data[a]=b);return this},
h=function(b,a){void 0===a&&(a="CId");return g.call(this,b,a+".since")},k=function(b,a){void 0===a&&(a="CId");return g.call(this,b,a+".until")},j=function(b,a){void 0===a&&(a="CId");return g.call(this,b,a+".start")},l=function(b,a){void 0===a&&(a="CId");return g.call(this,b,a+".end")},m=a.Model.extend({isDeleted:function(){return this._forDelete||this.data.DeletedOn},syncAdapter:f,xfilter:d,since:h,until:k,start:j,end:l}),o=function(a){"object"===typeof a&&(a.syncAdapter=b);a.modelDataBuild=function(b){return o(b)};
return a},p=a.Model.extend({syncAdapter:b,xfilter:d,since:h,until:k}),t=a.Collection.extend({xfilter:d,since:h,until:k,start:j,end:l,asc:function(b){return g.call(this,b,"asc")},desc:function(b){return g.call(this,b,"desc")},limit:function(b){return g.call(this,b,"limit")},offset:function(b){return g.call(this,b,"offset")},syncAdapter:f}),d=a.Collection.extend({xfilter:d,since:h,until:k,start:j,end:l,syncAdapter:b});m.extend=function(){var b=a.Model.extend.apply(this,arguments),d=new a.UniqueContainer;
c.extend(b.prototype,{_uniq:d,pushUnique:function(){return d.set(this.hash(),this)}},arguments[0]);return b};return{Auth:o,Model:m,AuthModel:p,Collection:t,AuthCollection:d,Sync:f,AuthSync:b,View:a.View,Url:a.Url,Register:a.Register}});
define("gizmo/view-events",["jquery","gizmo/superdesk"],function(c,a){return c.extend({View:a.View.extend({off:function(a,e){c(this).off(a,e);return this},on:function(a,e,b){if(void 0===b)c(this).off(a,e),c(this).on(a,e);else c(this).on(a,function(){e.apply(b,arguments)});return this},one:function(a,e,b){if(void 0===b)c(this).off(a,e),c(this).one(a,e);else c(this).one(a,function(){e.apply(b,arguments)});return this},trigger:function(a,e){c(this).trigger(a,e);return this},triggerHandler:function(a,
e){c(this).triggerHandler(a,e);return this}})},a)});
define("utils/json_parse",[],function(){var c,a,f={'"':'"',"'":"'","\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},e,b=function(b){throw{name:"SyntaxError",message:b,at:c,text:e};},d=function(d){d&&d!==a&&b("Expected '"+d+"' instead of '"+a+"'");a=e.charAt(c);c+=1;return a},g=function(){var c;c="";"-"===a&&(c="-",d("-"));for(;"0"<=a&&"9">=a;)c+=a,d();if("."===a)for(c+=".";d()&&"0"<=a&&"9">=a;)c+=a;if("e"===a||"E"===a){c+=a;d();if("-"===a||"+"===a)c+=a,d();for(;"0"<=a&&"9">=a;)c+=a,d()}c=+c;
if(isFinite(c))return c;b("Bad number")},h=function(){var c,e,g="",h;if('"'===a)for(;d();){if('"'===a)return d(),g;if("\\"===a)if(d(),"u"===a){for(e=h=0;4>e;e+=1){c=parseInt(d(),16);if(!isFinite(c))break;h=16*h+c}g+=String.fromCharCode(h)}else if("string"===typeof f[a])g+=f[a];else break;else g+=a}else if("'"===a)for(;d();){if("'"===a)return d(),g;if("\\"===a)if(d(),"u"===a){for(e=h=0;4>e;e+=1){c=parseInt(d(),16);if(!isFinite(c))break;h=16*h+c}g+=String.fromCharCode(h)}else if("string"===typeof f[a])g+=
f[a];else break;else g+=a}b("Bad string")},k=function(){var c,e,g="",h;if('"'===a)for(;d();){if('"'===a)return d(),g;if("\\"===a)if(d(),"u"===a){for(e=h=0;4>e;e+=1){c=parseInt(d(),16);if(!isFinite(c))break;h=16*h+c}g+=String.fromCharCode(h)}else if("string"===typeof f[a])g+=f[a];else break;else g+=a}else if("'"===a)for(;d();){if("'"===a)return d(),g;if("\\"===a)if(d(),"u"===a){for(e=h=0;4>e;e+=1){c=parseInt(d(),16);if(!isFinite(c))break;h=16*h+c}g+=String.fromCharCode(h)}else if("string"===typeof f[a])g+=
f[a];else break;else g+=a}else for(g+=a;d();){if(" "===a||":"===a||"}"===a)return g;if("\\"===a)if(d(),"u"===a){for(e=h=0;4>e;e+=1){c=parseInt(d(),16);if(!isFinite(c))break;h=16*h+c}g+=String.fromCharCode(h)}else if("string"===typeof f[a])g+=f[a];else break;else g+=a}b("Bad key")},j=function(){for(;a&&" ">=a;)d()},l=function(){switch(a){case "t":return d("t"),d("r"),d("u"),d("e"),!0;case "f":return d("f"),d("a"),d("l"),d("s"),d("e"),!1;case "n":return d("n"),d("u"),d("l"),d("l"),null}b("Unexpected '"+
a+"'")},m,o=function(){var c,e={};if("{"===a){d("{");j();if("}"===a)return d("}"),e;for(;a;)if(c=k(),j(),":"===a){d(":");e.hasOwnProperty.call(e,c)&&b('Duplicate key "'+c+'"');e[c]=m();j();if("}"===a)return d("}"),e;d(",");j()}else{if("}"===a)return d("}"),"{"+c+"}";b("Bad object")}}b("Bad injection")};m=function(){j();switch(a){case "{":return o();case "[":var c;a:{c=[];if("["===a){d("[");j();if("]"===a){d("]");break a}for(;a;){c.push(m());j();if("]"===a){d("]");break a}d(",");j()}}b("Bad array");
c=void 0}return c;case '"':return h();case "'":return h();case "-":return g();default:return"0"<=a&&"9">=a?g():l()}};return function(d,g){var f;e=d;c=0;a=" ";f=m();j();a&&b("Syntax error");return"function"===typeof g?function r(b,a){var d,c,e=b[a];if(e&&"object"===typeof e)for(d in e)Object.prototype.hasOwnProperty.call(e,d)&&(c=r(e,d),void 0!==c?e[d]=c:delete e[d]);return g.call(b,a,e)}({"":f},""):f}});
define("utils/twitter",[],function(){return{link:{anchor:function(c){return c.replace(/[\u00e4\u00e9\u00f6\u00fc\u00df\u00c4\u00d6\u00dcA-Za-z]+:\/\/[\u00e4\u00e9\u00f6\u00fc\u00df\u00c4\u00d6\u00dcA-Za-z0-9-_]+\.[\u00e4\u00e9\u00f6\u00fc\u00df\u00c4\u00d6\u00dcA-Za-z0-9-_:%&\?\/.=]+/g,function(a){a=a.link(a);return a=a.replace('href\x3d"','target\x3d"_blanka" href\x3d"')})},user:function(c){return c.replace(/[@]+[\u00e4\u00e9\u00f6\u00fc\u00df\u00c4\u00d6\u00dcA-Za-z0-9-_]+/g,function(a){var c=a.replace("@",
"");a=a.link("http://twitter.com/"+c);return a=a.replace('href\x3d"','target\x3d"_blankb" onclick\x3d"loadProfile(\''+c+'\');return(false);"  href\x3d"')})},tag:function(c){return c.replace(/[#]+[\u00e4\u00e9\u00f6\u00fc\u00df\u00c4\u00d6\u00dcA-Za-z0-9-_]+/g,function(a){var c=a.replace("#","%23");a=a.link("http://twitter.com/search?q\x3d"+c);return a=a.replace('href\x3d"','target\x3d"_blank" href\x3d"')})},all:function(c){c=this.anchor(c);c=this.user(c);return c=this.tag(c)}}}});
define("dust/dust-helpers",["dust/dust","jquery","utils/twitter","jquery/i18n","jquery/utils"],function(c,a,f){function e(b){return function(a){try{return a=JSON.parse(a),a.annotation[b]}catch(c){}return""}}var b=function(b,c,e,f){if(a.isDefined(f.param1)){var j=[],l;a.each(f,function(a,e){"function"===typeof e&&(val="",b.tap(function(b){val+=b;return""}).render(e,c).untap(),e=val);l=parseInt(a.slice(5))-1;if(isNaN(l)&&window.console)return window.console.log("Invalid parameter "+a+" given!"),[];
j[l]=e});return j}a.each(f,function(a,e){"function"===typeof e&&(val="",b.tap(function(b){val+=b;return""}).render(e,c).untap(),f[a]=val)});return f};c.helpers={i18n:function(d,c,e,f){msgid=f.msgid;msgid_plural=f.msgid_plural;n=f.n;domain=f.domain;msgctxt=f.msgctxt;f&&f.msgid?(delete f.msgid,d.write(a.i18n.dcnpgettext(domain,msgctxt,msgid,msgid_plural,n).format(b(d,c,e,f)))):window.console&&window.console.log("No expression given!");return d},sep:function(b,a,c){return a.stack.index===a.stack.of-
1?b:c.block(b,a)},idx:function(b,a,c){return c.block(b,a.push(a.stack.index))},"if":function(b,a,c,e){var f=e.cond;if(e&&e.cond){"function"===typeof f&&(f="",b.tap(function(b){f+=b;return""}).render(e.cond,a).untap(),""===f&&(f=!1));if(eval(f))return b.render(c.block,a);if(c["else"])return b.render(c["else"],a)}else window.console&&window.console.log("No expression given!");return b}};c.filters.t=function(b){return a("\x3cdiv\x3e"+b+"\x3c/div\x3e").text()};c.filters.twitter_all=function(b){return f.link.all(b)};
c.filters.twitter_annotation_before=e(0);c.filters.twitter_annotation_after=e(1);return c});define("dust/core",["dust/dust","dust/dust-helpers"],function(c){return c});
define("jquery/tmpl",["jquery","dust/core"],function(c,a){c.fn.extend({tmpl:function(a,e,b){if(""!==a)return"#"===a[0]&&(a=a.slice(1)),c.isFunction(e)&&(b=e),this.each(function(){$that=c(this);c.tmpl(a,e,function(a,e){a?window.console&&window.console.log(a):$that.html(e);c.isFunction(b)&&b.apply($that)})})}});c.extend({tmpl:function(c,e,b){a.render(c,e,b)},tmplFn:function(c){return a.compileFn(c)}})});
define("utils/encode_url",[],function(){encodeURL=function(c){return encodeURIComponent(c).replace(/'/g,"%27").replace(/~/g,"%7E").replace(/!/g,"%21").replace(/\*/g,"%2A").replace(/\(/g,"%28").replace(/\)/g,"%29")}});
define("utils/extend",[],function(){Array.prototype.forEach||(Array.prototype.forEach=function(b,a){for(var c=0,e=this.length;c<e;++c)b.call(a||this,this[c],c,this)});Function.prototype.bind||(Function.prototype.bind=function(b){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var a=Array.prototype.slice.call(arguments,1),c=this,e=function(){},f=function(){return c.apply(this instanceof e?this:b,a.concat(Array.prototype.slice.call(arguments)))};
e.prototype=this.prototype;f.prototype=new e;return f});String.prototype.trim||(String.prototype.trim=function(){for(var b=this.replace(/^\s\s*/,""),a=/\s/,c=b.length;a.test(b.charAt(--c)););return b.slice(0,c+1)});var c=Date,a=c.parse,f=[1,4,5,6,7,10,11];c.parse=function(b){var d,e=0;if(d=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/.exec(b)){b=0;for(var h;h=f[b];++b)d[h]=+d[h]||0;d[2]=(+d[2]||1)-1;d[3]=+d[3]||
1;"Z"!==d[8]&&void 0!==d[9]&&(e=60*d[10]+d[11],"+"===d[9]&&(e=0-e));d=c.UTC(d[1],d[2],d[3],d[4],d[5]+e,d[6],d[7])}else d=a?a(b):NaN;return d};if(!Date.prototype.toISOString){var e=function(b){b=String(b);1===b.length&&(b="0"+b);return b};Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1E3).toFixed(3)).slice(2,
5)+"Z"}}String.prototype.trunc=function(b,a){var c=this.length>b,e=c?this.substr(0,b-1):this,e=a&&c?e.substr(0,e.lastIndexOf(" ")):e;return c?e+"...":e}});
define("tmpl",["jquery","dust/compiler","dust/i18n_parse","jquery/xdomainrequest"],function(c,a,f){var e=function(){throw Error("Environment unsupported.");},b={};if("undefined"!==typeof window&&window.navigator&&window.document||"undefined"!==typeof importScripts)e=function(b,a){c.ajax({url:b,error:function(b,d){console.log("err");"parsererror"==d&&a(b.responseText)},success:function(b){a(b)}})};return{pluginBuilder:"tmpl-build",write:function(a,c,e){b.hasOwnProperty(c)&&e.asModule(a+"!"+c,b[c])},
load:function(d,c,h,k){var j=c.toUrl(d+".dust");e(j,function(c){c=f(c);try{c="define(['dust'],function(dust){"+a.compile(c,d)+" return {render: function(context, callback) {return dust.render('"+d+"', context, callback)}}})"}catch(e){throw e.message="In "+j+", "+e.message,e;}k.isBuild&&(b[d]=c);k.isBuild||(c+="\r\n//@ sourceURL\x3d"+j);h.fromText("tmpl!"+d,c)})}}});
define("livedesk-embed/views/post","jquery gizmo/superdesk utils/json_parse jquery/tmpl jquery/utils utils/encode_url tmpl!theme/item/base tmpl!theme/item/item tmpl!theme/item/annotated tmpl!theme/item/social-share tmpl!theme/item/posttype/normal tmpl!theme/item/posttype/image tmpl!theme/item/posttype/wrapup tmpl!theme/item/posttype/quote tmpl!theme/item/posttype/link tmpl!theme/item/posttype/advertisement tmpl!theme/item/source/advertisement tmpl!theme/item/source/google tmpl!theme/item/source/twitter tmpl!theme/item/source/facebook tmpl!theme/item/source/youtube tmpl!theme/item/source/flickr tmpl!theme/item/source/comments tmpl!theme/item/source/soundcloud tmpl!theme/item/source/instagram tmpl!theme/item/source/sms".split(" "),function(c,
a,f){return a.View.extend({init:function(){var a=this;a.xfilter="PublishedOn, DeletedOn, Order, Id, CId, Content, CreatedOn, Type, AuthorName, Author.Source.Name, Author.Source.Id, IsModified, AuthorPerson.EMail, AuthorPerson.FirstName, AuthorPerson.LastName, AuthorPerson.Id, Meta, IsPublished, Creator.FullName";a.model.on("read update",function(b,c){a._parent.model.get("PostPublished").isCollectionDeleted(a.model)||a.render(b,c)}).on("delete",a.remove,a).xfilter(a.xfilter).sync()},remove:function(){this._parent.removeOne(this);
this.el.remove();this.model.off("read update delete");return this},toggleWrap:function(a,b){"boolean"!=typeof b&&(b=!1);this._toggleWrap(c(a).closest("li").first(),b)},_toggleWrap:function(a){a.hasClass("open")?(a.removeClass("open").addClass("closed"),a.nextUntil(".wrapup,#loading-more").hide()):(a.removeClass("closed").addClass("open"),a.nextUntil(".wrapup,#loading-more").show())},render:function(a,b){var d=this;b=d.model.feed();var g=parseFloat(d.model.get("Order")),h;!isNaN(d.order)&&g!=d.order&&
d._parent.orderOne(d);b.HashIdentifier=d._parent.hashIdentifier;b.Meta&&(b.Meta="object"!==typeof JSON?f(b.Meta):JSON.parse(b.Meta));b.Meta&&b.Meta.annotation&&(null===b.Meta.annotation[1]&&(b.Meta.annotation=b.Meta.annotation[0],b.Meta.annotation=c.trimTag(["\x3cbr\x3e","\x3cbr /\x3e"],b.Meta.annotation)),"string"!==typeof b.Meta.annotation?b.Meta.annotation[0]?(g=b.Meta.annotation,b.Meta.annotation={before:c.trimTag(["\x3cbr\x3e","\x3cbr /\x3e"],g[0]),after:c.trimTag(["\x3cbr\x3e","\x3cbr /\x3e"],
g[1])}):b.Meta.annotation={before:c.trimTag(["\x3cbr\x3e","\x3cbr /\x3e"],b.Meta.annotation.before),after:c.trimTag(["\x3cbr\x3e","\x3cbr /\x3e"],b.Meta.annotation.after)}:b.Meta.annotation=c.trimTag(["\x3cbr\x3e","\x3cbr /\x3e"],b.Meta.annotation));h=d._parent.hashIdentifier+b.Order;-1===d._parent.location.indexOf("?")?b.permalink=d._parent.location+"?"+h:-1!==d._parent.location.indexOf(d._parent.hashIdentifier)?(g=RegExp(d._parent.hashIdentifier+"[^\x26]*"),b.permalink=d._parent.location.replace(g,
h)):b.permalink=d._parent.location+"\x26"+h;"True"===b.Author.Source.IsModifiable||"internal"===b.Author.Source.Name?b.item="posttype/"+b.Type.Key:b.Type&&(b.item="source/"+b.Author.Source.Name);b.CreatedOn&&(g=new Date(Date.parse(b.CreatedOn)),b.CreatedOn=g.format(_("mm/dd/yyyy HH:MM o")),b.CreatedOnISO=g.getTime());b.PublishedOn&&(publishedOn=new Date(Date.parse(b.PublishedOn)),b.PublishedOn=publishedOn.format(_("mm/dd/yyyy HH:MM o")),b.PublishedOnISO=publishedOn.getTime());b.Content&&(b.Content=
b.Content.replace(livedesk.server(),livedesk.FrontendServer));"source/comments"===b.item&&(b.Meta&&b.Meta.AuthorName)&&(g=b.Meta.AuthorName.replace("commentator",""),b.Meta.AuthorName=_("%(full_name)s commentator").format({full_name:g}));c.tmpl("theme/item/item",b,function(a,e){if(a)console.error(a);else{d.setElement(e);var f=c('input[data-type\x3d"permalink"]',d.el);c('a[rel\x3d"bookmark"]',d.el).on(d.getEvent("click"),function(b){b.preventDefault();"visible"===f.css("visibility")?f.css("visibility",
"hidden"):(f.css("visibility","visible"),f.trigger(d.getEvent("focus")),c(".result-header .share-box",d.el).fadeOut("fast"))});f.on(d.getEvent("focus")+" "+d.getEvent("click"),function(){c(this).select()});c(".big-toggle",d.el).off(d.getEvent("click")).on(d.getEvent("click"),function(){d.toggleWrap(this,!0)});c(".result-header",d.el).parent().hover(function(){},function(){c(this).find(".share-box").fadeOut(100);c('input[data-type\x3d"permalink"]',d.el).css("visibility","hidden")});c(".sf-share",d.el).on(d.getEvent("click"),
function(a){a.preventDefault();var e=c(this);if("yes"!=e.attr("data-added")){a=encodeURL(d._parent.model.get("Title"));var f=encodeURL(b.permalink),g=c(".result-content img:first",d.el).attr("src"),h="",j=!1;if(g){var k=new Image;k.src=g;100<=k.width&&200<=k.height&&(h=g,j=!0)}if(!j&&(g=c("iframe",d.el).attr("src")))g=g.toString(),-1!=g.indexOf("youtube")&&(h=b.Meta.thumbnail.hqDefault,j=!0);var g=encodeURL(c(".result-content .result-text:last",d.el).text()),h="http://pinterest.com/pin/create/button/?url\x3d"+
f+"\x26media\x3d"+h+"\x26description\x3d"+a,k="https://plus.google.com/share?url\x3d"+f+"\x26t\x3d",l="mailto:?to\x3d\x26subject\x3d"+_("Check out this Live Blog")+"\x26body\x3d"+f,q="http://www.facebook.com/sharer.php?s\x3d100",q=q+("\x26p[title]\x3d"+a),q=q+("\x26p[summary]\x3d"+g),q=q+("\x26p[url]\x3d"+f),v=0;c(".result-content img",d.el).each(function(){var b=c(this).attr("src");q+="\x26p[images]["+v+"]\x3d"+b;v++});a={fbclick:"$.socialShareWindow('"+q+"',400,570); return false;",twtclick:"$.socialShareWindow('http://twitter.com/home?status\x3d"+
_("Now reading ")+a+": "+f+"',400,570); return false;",linclick:"$.socialShareWindow('http://www.linkedin.com/shareArticle?mini\x3dtrue\x26url\x3d"+f+"\x26title\x3d"+a+"\x26summary\x3d"+g+"', 400, 570); return false;",pinclick:"$.socialShareWindow('"+h+"', 400, 700); return false;",gglclick:"$.socialShareWindow('"+k+"', 400, 570); return false;",emailclick:"$.socialShareWindow('"+l+"', 1024, 768); return false;",emailurl:l,showPin:j};c.tmpl("theme/item/social-share",a,function(b,a){e.after(a);e.attr("data-added",
"yes")})}c('input[data-type\x3d"permalink"]',d.el).css("visibility","hidden");c(this).next(".share-box").toggle()})}});setTimeout(function(){})}})});
define("utils/date-format",["jquery","jquery/i18n"],function(){var c,a=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,f=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,e=/[^-+\dA-Z]/g,b=function(b,a){b=String(b);for(a=a||2;b.length<a;)b="0"+b;return b};c=function(d,g,h){1==arguments.length&&("[object String]"==Object.prototype.toString.call(d)&&!/\d/.test(d))&&(g=d,d=void 0);d=d?new Date(d):new Date;
if(isNaN(d))throw SyntaxError("invalid date");g=String(c.masks[g]||g||c.masks["default"]);"UTC:"==g.slice(0,4)&&(g=g.slice(4),h=!0);var k=h?"getUTC":"get",j=d[k+"Date"](),l=d[k+"Day"](),m=d[k+"Month"](),o=d[k+"FullYear"](),p=d[k+"Hours"](),t=d[k+"Minutes"](),s=d[k+"Seconds"](),k=d[k+"Milliseconds"](),u=h?0:d.getTimezoneOffset(),r={d:j,dd:b(j),ddd:c.i18n.dayNames[l],dddd:c.i18n.dayNames[l+7],m:m+1,mm:b(m+1),mmm:c.i18n.monthNames[m],mmmm:c.i18n.monthNames[m+12],yy:String(o).slice(2),yyyy:o,h:p%12||
12,hh:b(p%12||12),H:p,HH:b(p),M:t,MM:b(t),s:s,ss:b(s),l:b(k,3),L:b(99<k?Math.round(k/10):k),t:12>p?"a":"p",tt:12>p?"am":"pm",T:12>p?"A":"P",TT:12>p?"AM":"PM",Z:h?"UTC":(String(d).match(f)||[""]).pop().replace(e,""),o:(0<u?"-":"+")+b(100*Math.floor(Math.abs(u)/60)+Math.abs(u)%60,4),S:["th","st","nd","rd"][3<j%10?0:(10!=j%100-j%10)*j%10]};return g.replace(a,function(b){return b in r?r[b]:b.slice(1,b.length-1)})};c.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",
longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};c.i18n={dayNames:"Sun Mon Tue Wed Thu Fri Sat Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),monthNames:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec January February March April May June July August September October November December".split(" ")};
Date.prototype.format=function(b,a){return c(this,b,a)};return c});
define("utils/ie-polyfill",[],function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(c){if(void 0===this||null===this)throw new TypeError;var a=Object(this),f=a.length>>>0;if(0===f)return-1;var e=0;0<arguments.length&&(e=Number(arguments[1]),e!==e?e=0:0!==e&&(Infinity!==e&&-Infinity!==e)&&(e=(0<e||-1)*Math.floor(Math.abs(e))));if(e>=f)return-1;for(e=0<=e?e:Math.max(f-Math.abs(e),0);e<f;e++)if(e in a&&a[e]===c)return e;return-1})});
define("livedesk-embed/dispatcher",["jquery"],function(c){var a=function(){};a.prototype={on:function(a,e){c(this).on(a,function(b,a){e.call(a)})},triggerHandler:function(a,e){c(this).triggerHandler(a,[e])}};c.dispatcher=new a});define("window",[],function(){return window});define("document",[],function(){return document});
define("jquery/scrollspy",["jquery","window","document"],function(c,a){c.fn.extend({scrollspy:function(f){f=c.extend({},{min:0,max:0,mode:"vertical",buffer:0,container:a,onEnter:f.onEnter?f.onEnter:[],onLeave:f.onLeave?f.onLeave:[],onTick:f.onTick?f.onTick:[]},f);return this.each(function(){var a=this,b=f,d=c(b.container),g=b.mode,h=b.buffer,k=leaves=0,j=!1;d.bind("scroll",function(){var f={top:c(this).scrollTop(),left:c(this).scrollLeft()},m="vertical"==g?f.top+h:f.left+h,o=b.max,p=b.min;c.isFunction(b.max)&&
(o=b.max());c.isFunction(b.min)&&(p=b.min());0==o&&(o="vertical"==g?d.height():d.outerWidth()+c(a).outerWidth());if(m>=p&&m<=o){if(!j&&(j=!0,k++,c(a).trigger("scrollEnter",{position:f}),c.isFunction(b.onEnter)))b.onEnter(a,f);c(a).trigger("scrollTick",{position:f,inside:j,enters:k,leaves:leaves});if(c.isFunction(b.onTick))b.onTick(a,f,j,k,leaves)}else if(j&&(j=!1,leaves++,c(a).trigger("scrollLeave",{position:f,leaves:leaves}),c.isFunction(b.onLeave)))b.onLeave(a,f)})})}})});
define("livedesk-embed/collections/autocollection",["gizmo/superdesk"],function(c){return c.Collection.extend({_timeInterval:1E4,_idInterval:0,_stats:{},keep:!1,resetStats:function(){this._stats={limit:15,offset:0,lastCId:0,firstOrder:Infinity,total:0}},init:function(){var a=this;a.resetStats();a.model.on("publish reorder",function(c,e){a._stats.lastCId+1===parseInt(e.get("CId"))&&a._stats.lastCId++});a.on("read readauto",function(c,e,b){a._stats.offset=a._stats.limit;a._stats.total=parseInt(b.total);
b.lastCId=parseInt(b.lastCId);b.lastCId>a._stats.lastCId&&(a._stats.lastCId=b.lastCId);a.getFirstOrder(e)}).on("readauto updatesauto addingsauto removeingsauto update",function(c,e){a.getLastCid(e);a.getFirstOrder(e)}).on("addingsauto",function(c,e){a._stats.total+=e.length;a._stats.offset+=e.length}).on("removeingsauto",function(c,e){a._stats.total-=e.length;a._stats.offset-=e.length}).on("addings",function(c,e){a._stats.offset+=e.length})},destroy:function(){this.stop()},auto:function(a){var c=
this;ret=this.stop().start(a);this._idInterval=setInterval(function(){c.start(a)},this._timeInterval);return ret},start:function(a){a=a||{};a=$.extend(!0,{data:{"cId.since":this._stats.lastCId,"order.start":this._stats.firstOrder},headers:{"X-Filter":this._xfilter,"X-Format-DateTime":"yyyy-MM-ddTHH:mm:ss'Z'"}},a);0===this._stats.lastCId&&(delete a.data["cId.since"],delete a.data["order.start"]);Infinity===this._stats.firstOrder&&delete a.data["order.start"];if(!this.keep&&this.view&&!this.view.checkElement())this.stop();
else return this.autosync(a)},stop:function(){clearInterval(this._idInterval);return this},getFirstOrder:function(a){for(var c=0,e,b=a.length;c<b;c++)e=parseFloat(a[c].get("Order")),!isNaN(e)&&this._stats.firstOrder>e&&(this._stats.firstOrder=e)},getLastCid:function(a){for(var c=0,e,b=a.length;c<b;c++)e=parseInt(a[c].get("CId")),!isNaN(e)&&this._stats.lastCId<e&&(this._stats.lastCId=e)},autosync:function(a){var c=this;return this.href&&this.syncAdapter.request.call(this.syncAdapter,this.href).read(a).done(function(a){var b=
c.parseAttributes(a);a=c._parse(a);for(var d=[],g=[],h=[],k=[],j=c._list.length,l=0;l<a.length;l++){for(var m=!1,o=0;o<c._list.length;o++)if(a[l].hash()==c._list[o].hash()){m=a[l];break}if(m)if(c.hasEvent("updatesauto")&&h.push(m),c.isCollectionDeleted(m)&&(c._list.splice(o,1),c.hasEvent("removeingsauto")&&g.push(m)),m.isDeleted())m._remove();else if(m.isChanged())d.push(m);else m.on("delete",function(){c.remove(this.hash())}).on("garbage",function(){this.desynced=!0});else c.isCollectionDeleted(a[l])?
c.hasEvent("removeingsauto")&&c.hasEvent("removeingsauto")&&g.push(a[l]):a[l].isDeleted()?c.hasEvent("updatesauto")&&h.push(a[l]):(c._list.push(a[l]),d.push(a[l]),c.hasEvent("addingsauto")&&k.push(a[l]))}c.desynced=!1;0===j?c.triggerHandler("readauto",[c._list,b]):(h.length&&c.hasEvent("updatesauto")&&c.triggerHandler("updatesauto",[h,b]),k.length&&c.hasEvent("addingsauto")&&c.triggerHandler("addingsauto",[k,b]),g.length&&c.hasEvent("removeingsauto")&&c.triggerHandler("removeingsauto",[g,b]),c.triggerHandler("updateauto",
[d,b]))})}},{register:"AutoCollection"})});define("livedesk-embed/models/user",["gizmo/superdesk"],function(c){return c.Model.extend({},{register:"User"})});
define("livedesk-embed/models/post",["gizmo/superdesk","livedesk-embed/models/user","utils/extend"],function(c){return c.Model.extend({defaults:{Creator:c.Register.User},services:{flickr:!0,google:!0,twitter:!0,facebook:!0,youtube:!0},getClass:function(){switch(this.get("Type").Key){case "wrapup":return"wrapup";case "quote":return"quotation";case "advertisement":return"advertisement";default:return this.isService()?"service":"tw"}},isService:function(){return this.get("AuthorName")in this.services},
isQuote:function(){return"quotation"==this.getClass()},twitter:{link:{anchor:function(a){return a.replace(/[A-Za-z]+:\/\/[A-Za-z0-9-_]+\.[A-Za-z0-9-_:%&\?\/.=]+/g,function(a){a=a.link(a);return a=a.replace('href\x3d"','target\x3d"_blank" href\x3d"')})},user:function(a){return a.replace(/[@]+[A-Za-z0-9-_]+/g,function(a){var c=a.replace("@","");a=a.link("http://twitter.com/"+c);return a=a.replace('href\x3d"','target\x3d"_blank" onclick\x3d"loadProfile(\''+c+'\');return(false);"  href\x3d"')})},tag:function(a){return a.replace(/[#]+[A-Za-z0-9-_]+/g,
function(a){var c=a.replace(" #"," %23");a=a.link("http://summize.com/search?q\x3d"+c);return a=a.replace('href\x3d"','target\x3d"_blank" href\x3d"')})},all:function(a){a=this.anchor(a);a=this.user(a);return a=this.tag(a)}}}},{register:"Post"})});
define("livedesk-embed/collections/posts",["gizmo/superdesk","livedesk-embed/collections/autocollection","livedesk-embed/models/post"],function(c){return c.Register.AutoCollection.extend({parse:function(a){void 0!==a.total&&(a.total=parseInt(a.total),this.listTotal=a.total,delete a.total);return a.PostList?a.PostList:a},parseAttributes:function(a){return{lastCId:a.lastCId,offset:a.offset,offsetMore:a.offsetMore,total:a.total,limit:a.limit}},isCollectionDeleted:function(a){return"False"===a.get("IsPublished")},
model:c.Register.Post},{register:"Posts"})});define("livedesk-embed/models/blog",["gizmo/superdesk","livedesk-embed/collections/posts"],function(c){return c.Model.extend({defaults:{PostPublished:c.Register.Posts}},{register:"Blog"})});
define("jquery/xdomainrequest",["jquery"],function(c){c.support.cors=!0;var a=0,f=0;this.XDomainRequest&&c.ajaxTransport("+*",function(e){if(e.crossDomain&&e.async){e.timeout&&(e.xdrTimeout=e.timeout,delete e.timeout);var b,d;return{send:function(g,h){function k(a,d,e,f){b.onload=b.onerror=b.ontimeout=c.noop;b=void 0;h(a,d,e,f)}b=new XDomainRequest;if(e.dataType){var j="";for(i in e.headers)j+=i+"\x3d"+encodeURIComponent(e.headers[i])+"\x26";j=j.replace(/(\s+)?.$/,"");e.url=e.url+(-1===e.url.indexOf("?")?
"?":"\x26")+j}b.open(e.type,e.url);d=e.processTime?e.processTime:80*a++;b.onload=function(){setTimeout(function(){k(200,"OK",{text:b.responseText},"Content-Type: "+b.contentType);a=0},f)};f=d;b.onerror=function(){k(404,"Not Found")};e.xdrTimeout&&(b.ontimeout=function(){k(0,"timeout")},b.timeout=e.xdrTimeout);b.send(e.hasContent&&e.data||null)},abort:function(){b&&(b.onerror=c.noop(),b.abort())}}}})});
define("livedesk-embed/views/timeline","jquery gizmo/view-events livedesk-embed/views/post utils/date-format utils/ie-polyfill livedesk-embed/dispatcher jquery/tmpl jquery/scrollspy livedesk-embed/models/blog tmpl!theme/container jquery/xdomainrequest".split(" "),function(c,a,f,e){e.i18n={dayNames:_("Sun,Mon,Tue,Wed,Thu,Fri,Sat,Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday").toString().split(","),monthNames:_("Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec,January,February,March,April,May,June,July,August,September,October,November,December").toString().split(",")};
return a.View.extend({limit:6,hashIdentifier:"livedeskitem\x3d",location:"",_views:[],el:"#livedesk-root",timeInterval:1E4,events:{"#loading-more":{click:"loadingMore"},"#load-more":{click:"loadMore"}},idInterval:0,flags:{},scroll:{element:null,start:0},resetFlags:function(){this.flags={addAllPending:!1,more:!1,loadingMore:!1,atEnd:!1}},autoRender:!0,pendingAutoupdates:[],loadMore:function(){this.resetFlags();this.el.find("#liveblog-post-list").html("");i=0;for(count=this._views.length;i<count;i++)this._views[i].rendered=
!1;this._views=[];delete this.filters;var b=this.model.get("PostPublished");b._list=[];b.resetStats();b.limit(b._stats.limit).offset(b._stats.offset).auto({data:{thumbSize:"medium"}});c(this).hide()},showLiner:function(){c("#load-more").show()},loadingMore:function(){var b=this;!b.flags.atEnd&&!b.flags.loadingMore&&(b.flags.loadingMore=!0,b.flags.more=!0,b.model.get("PostPublished"),postPublished=b.model.get("PostPublished"),b.filters&&c.each(b.filters,function(b,a){postPublished[b].apply(postPublished,
a)}),postPublished.xfilter(b.xfilter).limit(postPublished._stats.limit).offset(postPublished._stats.offset).sync({data:{thumbSize:"medium"}}).done(function(){var a=b.model.get("PostPublished").total;b.toggleMoreVisibility();b._views.length>=a&&(b.flags.atEnd=!0);b.flags.more=!1;b.flags.loadingMore=!1}))},more:function(){var b=this;!b.flags.atEnd&&!b.flags.more&&(b.flags.more=!0,b.model.get("PostPublished"),postPublished=b.model.get("PostPublished"),b.filters&&c.each(b.filters,function(b,a){postPublished[b].apply(postPublished,
a)}),postPublished.xfilter(b.xfilter).limit(postPublished._stats.limit).offset(postPublished._stats.offset).sync().done(function(){var a=b.model.get("PostPublished").total;b._views.length>=a&&(b.flags.atEnd=!0,c("#loading-more",b.el).hide());b.flags.more=!1}))},setIdInterval:function(b){this.idInterval=setInterval(b,this.timeInterval);return this},pause:function(){clearInterval(this.idInterval);return this},sync:function(){var b=this;this.auto().pause().setIdInterval(function(){b.auto()})},auto:function(){this.model.xfilter().sync({force:!0});
return this},gotoHash:function(){if(0<location.hash.length){var b=location.hash;location.hash="";location.hash=b}},init:function(){var b=this;b.resetFlags();b._views=[];b.location=window.location.href.split("#")[0];b.rendered=!1;"string"===c.type(b.url)&&(b.model=new a.Register.Blog(b.url.replace("my/","")));b.xfilter="PublishedOn, DeletedOn, Order, Id, CId, Content, CreatedOn, Type, AuthorName, Author.Source.Name, Author.Source.Id, Author.Source.IsModifiable, IsModified, AuthorImage, AuthorPerson.EMail, AuthorPerson.FirstName, AuthorPerson.LastName, AuthorPerson.Id, Meta, IsPublished, Creator.FullName";
b.model.on("read",function(){if(!b.rendered){var a,c=window.location.href.split("?"),e=b.model.get("PostPublished");e.on("read readauto",b.render,b).on("addings",b.addAll,b).on("addingsauto",b.addAllAutoupdate,b).on("removeingsauto",b.removeAllAutoupdate,b).xfilter(b.xfilter).limit(e._stats.limit);c[1]&&-1!==(a=c[1].indexOf(b.hashIdentifier))?(a=parseFloat(c[1].substr(a+b.hashIdentifier.length)),b.filters={end:[a,"order"]},e.one("rendered",b.showLiner,b).end(a,"order").sync({data:{thumbSize:"medium"}})):
e.offset(e._stats.offset).auto({data:{thumbSize:"medium"}})}b.rendered=!0}).on("update",function(){b.ensureStatus();b.renderBlog()}).on("sync",function(){b.updateingStatus()}).on("synced",function(){b.updateStatus()});b.sync()},removeOne:function(b){var a=this._views.indexOf(b);b=this.model.get("PostPublished")._list.indexOf(b.model);-1!==a&&(this.model.get("PostPublished").total--,this._views.splice(a,1),-1!==b&&this.model.get("PostPublished")._list.splice(b,1),this.markScroll());return this},orderOne:function(a){var c=
this.findView(a);a.order=parseFloat(a.model.get("Order"));-1===c&&this._views.push(a);this._views.sort(function(a,b){return b.order-a.order});c=this.findView(a);0===c?1===this._views.length?this.el.find("#load-more").after(a.el):a.el.insertBefore(this._views[1].el):a.el.insertAfter(this._views[c-1].el);return a},findView:function(a){for(var c=0,e=this._views.length;c<e;c++)if(a.model.href===this._views[c].model.href)return c;return-1},addOne:function(a){var c=new f({model:a,_parent:this});a.postView=
c;return this.orderOne(c)},toggleStatusCount:function(){if(0!==this.pendingAutoupdates.length){var a=this.pendingAutoupdates.length;c("#liveblog-status-count",this.el).text(ngettext("one new post","%(count)s new posts",a).format({count:a})).show()}else c("#liveblog-status-count",this.el).hide()},removeAllAutoupdate:function(a,c){for(var e in c)"postView"in c[e]&&c[e].postView.remove();this.markScroll()},addAllAutoupdate:function(a,c){if(this.autoRender){if(c.length){for(var e=0,f=c.length;e<f;e++)this.addOne(c[e]),
this.model.get("PostPublished").total++;this.markScroll()}}else 0!==c.length&&(this.pendingAutoupdates=this.pendingAutoupdates.concat(c),this.toggleStatusCount())},addAllPending:function(){if(!this.flags.addAllPending&&this.pendingAutoupdates.length){this.flags.addAllPending=!0;for(var a=0,c=this.pendingAutoupdates.length;a<c;a++)this.addOne(this.pendingAutoupdates[a]);this.pendingAutoupdates=[];this.toggleStatusCount();this.markScroll()}this.flags.addAllPending=!1},addAll:function(a,c){var e;e=0;
for(count=c.length;e<count;e++)this.addOne(c[e]);this.toggleMoreVisibility()},ensureStatus:function(){if(this.model.get("ClosedOn")){var a=new Date(Date.parse(this.model.get("ClosedOn")));this.pause();this.model.get("PostPublished").stop();this.el.find("#liveblog-status-time").html(_("The liveblog coverage was stopped ")+a.format(_("mm/dd/yyyy HH:MM")))}},updateingStatus:function(){this.el.find("#liveblog-status-time").html(_("updating...")+"")},updateStatus:function(){var a=this,d=new Date;void 0===
this.model.get("ClosedOn")&&this.el.find("#liveblog-status").fadeOut(function(){var e='\x3ctime data-date\x3d"'+d.getTime()+'"\x3e'+d.format(_("HH:MM"))+"\x3c/time\x3e";c(this).find("#liveblog-status-time").html(_("updated on %s").format([e])).end().fadeIn();c.dispatcher.triggerHandler("after-render",a)})},renderBlog:function(){c(this.el).find('[gimme\x3d"blog.title"]').html(this.model.get("Title")).end().find('[gimme\x3d"blog.description"]').html(this.model.get("Description"))},toggleMoreVisibility:function(){this.model.get("PostPublished")._stats.offset>=
this.model.get("PostPublished")._stats.total?c("#loading-more",this.el).hide():c("#loading-more",this.el).show()},markScroll:function(){this.scroll.element=c("#liveblog-posts :not(#load-more)",this.el).first();this.scroll.start=this.scroll.element.offset().top},render:function(){var a=this,d,e;e=a.model.get("PostPublished");a.el.tmpl("theme/container");a.renderBlog();a.ensureStatus();d=e._list;e.total=e.listTotal;a.toggleMoreVisibility();var f=d.length;a.views=[];a.renderedTotal=f;for(var f=0,k=d.length;f<
k;f++)d[f].on("rendered",a.renderedOn,a),e=a.addOne(d[f]),a.views.push(e);a.model.get("PostPublished").triggerHandler("rendered");c("#pintotop,#liveblog-status-count",a.el).on(a.getEvent("click"),function(d){d.preventDefault();c("#liveblog-posts",a.el).scrollTop(0)});a.markScroll();c("#liveblog-posts",a.el).scroll(function(){!a.flags.atEnd&&c(this).outerHeight()+1>=c(this).get(0).scrollHeight-c(this).scrollTop()&&a.more();a.scroll.element.offset().top<a.scroll.start?(a.autoRender=!1,c("#liveblog-status",
a.el).addClass("shadow")):(a.autoRender=!0,a.addAllPending(),c("#liveblog-status",a.el).removeClass("shadow"))});c.dispatcher.triggerHandler("after-render",this)},renderedOn:function(){this.renderedTotal--;this.renderedTotal||this.closeAllButFirstWrapup()},closeAllButFirstWrapup:function(a){a=this.views;a.reverse();for(var d=0;d<a.length;d++)c(a[d].el).hasClass("wrapup")&&a[d]._toggleWrap(c(a[d].el))}})});requirejs.config({paths:{recaptcha:"//www.google.com/recaptcha/api/js/recaptcha_ajax"}});
define("livedesk-embed/views/user-comments-popup",["jquery","gizmo/superdesk"],function(c,a){var f=a.Model.extend({save:function(a,b){return function(){return this.syncAdapter.request.apply(this.syncAdapter,arguments)}.call(this,a).insert(this.data,b)}});return a.View.extend({commentTokenId:"comment-token",events:{"#comment-btn":{click:"togglePopup"},"#comment-message-btn":{click:"showAfterMessage"},".button.cancel":{click:"togglePopup"},".button.send":{click:"send"},form:{submit:"send"}},messageDisplayTime:5E3,
init:function(){this.popup=c(this.el).find(".comment-box").hide();this.popup_message=c(this.el).find(".comment-box-message").hide();this.username=c(this.el).find("#comment-nickname");this.text=c(this.el).find("#comment-text");this.captcha=c("#"+this.commentTokenId);this.resetInput();this.loadRecaptcha=!0;this.href=this.model.data.CommentPost.href.replace("resources/","resources/my/");this.backdropel=c("#backdrop").data("show-status",0);this.lbpostlist=this.backdropel.parent()},togglePopup:function(a){var b=
this.backdropel.data("show-status");a.preventDefault();switch(b){case 0:this.popup.show();this.backdropel.data("show-status",1).show();this.lbpostlist.addClass("comment-active");this.timeline.pause();break;case 1:this.backdropel.data("show-status",0).hide();case 2:this.popup_message.hide(),this.resetInput(),this.lbpostlist.removeClass("comment-active"),this.popup.hide(),this.timeline.sync()}},resetInput:function(){this.username.val("");this.text.val("");c(this.el).find(".error").hide()},showAfterMessage:function(){var a=
this;a.backdropel.data("show-status",2).show();a.popup.toggle();a.backdropel.data("show-status",1);this.popup_message.show();setTimeout(function(){a.popup_message.hide({duration:0,done:function(){a.backdropel.data("show-status",0);a.backdropel.hide()}})},a.messageDisplayTime)},send:function(a){a.preventDefault();if(this.isValid()){var b=this;(new f({UserName:this.username.val(),CommentText:this.text.val()})).save(this.href,{success:function(){b.showAfterMessage(a)},error:function(){b.showAfterMessage(a)}})}},
initRecaptcha:function(){if(this.loadRecaptcha){this.loadRecaptcha=!1;var a=this;require(["recaptcha"],function(){Recaptcha.create(a.captcha.attr("data-public-key"),a.captcha.attr("id"),{theme:"clean"})})}},isValid:function(){this.username.val()?this.username.next(".error").hide():this.username.next(".error").show();this.text.val()?this.text.next(".error").hide():this.text.next(".error").show();return 0===c(this.el).find(".error:visible").length}})});define("livedesk-embed/plugins",function(){});